<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compra de Veículo - Stuttgart</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Estilos gerais para o formulário */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
        }

        h1 {
            text-align: center;
        }

        form {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin: 10px 0 5px;
        }

        input, select {
            width: 100%;
            padding: 8px;
            margin: 5px 0 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        button {
            background-color: #28a745;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button.cancel-button {
            background-color: #dc3545;
        }

        button:hover {
            opacity: 0.9;
        }

        footer {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <header>
        <h1>Compra de Veículo</h1>
    </header>

    <main>
        <form id="form-compra" onsubmit="finalizarCompra(event)">
            <label for="veiculo">Selecionar Veículo:</label>
            <select id="veiculo" required>
                <option value="">--Selecione um veículo--</option>
                <!-- As opções de veículos serão preenchidas aqui -->
            </select>
            <label for="nomeComprador">Nome do Comprador:</label>
            <input type="text" id="nomeComprador" placeholder="Nome do Comprador" required>
            <label for="cpfComprador">CPF do Comprador:</label>
            <input type="text" id="cpfComprador" placeholder="CPF do Comprador" required>
            <label for="telefoneComprador">Telefone do Comprador:</label>
            <input type="text" id="telefoneComprador" placeholder="Telefone do Comprador" required>
            <label for="emailComprador">Email do Comprador:</label>
            <input type="email" id="emailComprador" placeholder="Email do Comprador" required>
            <label for="valorTotal">Valor Total:</label>
            <input type="number" id="valorTotal" placeholder="Valor Total" required readonly>
            <button type="submit">Finalizar Compra</button>
            <button type="button" class="cancel-button" onclick="window.history.back()">Cancelar</button>
        </form>
    </main>

    <footer>
        <p>Stuttgart.INC since 1994</p>
    </footer>

    <script src="Exibe_Veiculos.js"></script>

    <script>
        async function buscarVeiculos() {
            try {
                const response = await fetch('http://localhost:3000/api/veiculos'); // Ajuste a URL conforme necessário
                if (!response.ok) throw new Error('Erro ao buscar veículos');
                const veiculos = await response.json();
                exibirVeiculos(veiculos);
            } catch (error) {
                console.error(error);
                alert('Erro ao carregar veículos.');
            }
        }

        function exibirVeiculos(veiculos) {
            const selectVeiculo = document.getElementById('veiculo');
            veiculos.forEach(veiculo => {
                const option = document.createElement('option');
                option.value = veiculo.id; // ou outro identificador
                option.textContent = `${veiculo.modelo} / ${veiculo.placa}`; // Mostra modelo e placa
                selectVeiculo.appendChild(option);
            });
        }

        function finalizarCompra(event) {
            event.preventDefault();
            // Lógica para processar a compra
            const compraData = {
                veiculoId: document.getElementById('veiculo').value,
                nome: document.getElementById('nomeComprador').value,
                cpf: document.getElementById('cpfComprador').value,
                telefone: document.getElementById('telefoneComprador').value,
                email: document.getElementById('emailComprador').value,
                valor: document.getElementById('valorTotal').value
            };

            // Enviar os dados da compra para o servidor (exemplo usando fetch)
            fetch('http://localhost:3000/api/compras', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(compraData)
            })
            .then(response => {
                if (!response.ok) throw new Error('Erro ao finalizar a compra');
                alert("Compra finalizada com sucesso!");
            })
            .catch(error => {
                console.error(error);
                alert('Erro ao finalizar a compra.');
            });
        }

        // Chama a função ao carregar a página
        window.onload = buscarVeiculos;
    </script>
</body>

</html>
